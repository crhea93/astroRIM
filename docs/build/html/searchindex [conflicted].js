Search.setIndex({"docnames": ["Notebooks/RIM-Test-1D-Gaussians", "index", "rim_model", "rim_physical", "rim_sequence"], "filenames": ["Notebooks/RIM-Test-1D-Gaussians.ipynb", "index.rst", "rim_model.rst", "rim_physical.rst", "rim_sequence.rst"], "titles": ["Recurrent Inference Machines", "Welcome to astroRIM\u2019s documentation!", "RIM Model", "RIM Physical", "RIM Sequence"], "terms": {"In": [0, 1], "thi": [0, 1, 2], "notebook": 0, "i": [0, 1, 2, 4], "develop": 0, "framework": 0, "us": [0, 1, 2], "solv": [0, 1], "basic": 0, "1d": [0, 1], "deconvolut": 0, "problem": [0, 1, 4], "The": 0, "given": [0, 4], "gaussian": 0, "profil": 0, "poisson": 0, "nois": [0, 3, 4], "can": [0, 1], "we": [0, 2, 4], "rim": [0, 1], "recov": 0, "origin": 0, "1": [0, 2, 4], "import": 0, "numpi": 0, "np": 0, "matplotlib": 0, "pyplot": 0, "plt": 0, "tensorflow": 0, "tf": 0, "from": [0, 2, 3, 4], "kera": 0, "layer": [0, 2], "time": [0, 2, 4], "sy": 0, "path": 0, "append": 0, "rim_sequ": [0, 4], "style": 0, "dark": 0, "mplstyle": 0, "11": 0, "n": 0, "50": 0, "size": 0, "spectrum": 0, "5000": 0, "number": [0, 4], "spectra": [0, 4], "12": 0, "def": 0, "x": [0, 2, 3, 4], "mu": 0, "sig": 0, "return": [0, 2, 3, 4], "exp": 0, "power": 0, "2": [0, 2], "conv_mat": 0, "convolut": [0, 2, 3], "matrix": [0, 3, 4], "an": [0, 1], "ident": 0, "ey": 0, "random": 0, "normal": 0, "0": 0, "05": 0, "create_convolv": 0, "ar": [0, 1], "28x28": 0, "arg": [0, 2, 4], "gausian": 0, "list": 0, "01": 0, "powerlaw": 0, "slope": 0, "gaussians_initi": 0, "initi": [0, 4], "powerlaw_conv": 0, "gaussians_fin": 0, "final": [0, 4], "after": 0, "ad": 0, "rang": 0, "32": 0, "point": 0, "linspac": 0, "gaus_orig": 0, "uniform": 0, "addit": 0, "conv_mat_": 0, "gaus_conv": 0, "add": 0, "noise_": 0, "gaus_nois": 0, "instanc": [0, 4], "13": 0, "5": 0, "plot": 0, "label": 0, "legend": 0, "lt": 0, "0x7fd2df3ad640": 0, "gt": 0, "14": 0, "train": [0, 2, 4], "valid": [0, 4], "test": [0, 4], "set": [0, 1, 4], "train_percentag": 0, "7": 0, "valid_percentag": 0, "9": 0, "test_percentag": 0, "len_x": 0, "len": 0, "x_train": [0, 2, 4], "int": [0, 4], "y_train": [0, 4], "a_train": [0, 4], "n_train": 0, "diag": 0, "noise_v": 0, "x_valid": [0, 4], "y_valid": [0, 4], "a_valid": [0, 4], "n_valid": 0, "x_test": [0, 4], "y_test": [0, 4], "a_test": [0, 4], "n_test": 0, "15": 0, "load": 0, "model": [0, 1, 3, 4], "defin": 0, "hyper": 0, "paramet": [0, 2, 3, 4], "epoch": [0, 4], "10": 0, "batch_siz": [0, 4], "8": 0, "rnn_units1": 0, "256": 0, "rnn_units2": 0, "conv_filt": 0, "kernel_s": 0, "input_s": 0, "dimens": 0, "t_step": 0, "learning_r": 0, "005": 0, "prepar": 0, "dataset": 0, "train_dataset": [0, 4], "data": [0, 4], "from_tensor_slic": 0, "batch": [0, 2, 4], "drop_remaind": 0, "true": [0, 2, 3, 4], "prefetch": 0, "val_dataset": [0, 4], "16": 0, "fit": [0, 1, 4], "ysol_valid": 0, "training_loss": 0, "valid_loss": 0, "complet": 0, "00": 0, "eta": [0, 4], "02": 0, "08": 0, "21": 0, "loss": [0, 4], "108e": 0, "mse": [0, 4], "125e": 0, "29": 0, "3": 0, "402e": 0, "445e": 0, "4": 0, "58": 0, "28": 0, "426e": 0, "212e": 0, "6": 0, "86": 0, "31": 0, "354e": 0, "774e": 0, "55": 0, "327e": 0, "664e": 0, "44": 0, "52": 0, "311e": 0, "972e": 0, "73": 0, "24": 0, "272e": 0, "457e": 0, "25": 0, "238e": 0, "136e": 0, "18": 0, "19": 0, "308e": 0, "858e": 0, "20": 0, "59": 0, "06": 0, "280e": 0, "668e": 0, "22": 0, "88": 0, "09": 0, "26": 0, "298e": 0, "498e": 0, "17": 0, "255e": 0, "362e": 0, "27": 0, "46": 0, "07": 0, "30": 0, "273e": 0, "250e": 0, "75": 0, "03": 0, "258e": 0, "152e": 0, "04": 0, "39": 0, "264e": 0, "073e": 0, "34": 0, "320e": 0, "003e": 0, "36": 0, "61": 0, "279e": 0, "942e": 0, "38": 0, "90": 0, "284e": 0, "884e": 0, "41": 0, "293e": 0, "837e": 0, "43": 0, "48": 0, "294e": 0, "793e": 0, "45": 0, "77": 0, "319e": 0, "753e": 0, "241e": 0, "714e": 0, "295e": 0, "686e": 0, "63": 0, "323e": 0, "656e": 0, "54": 0, "92": 0, "627e": 0, "57": 0, "296e": 0, "605e": 0, "216e": 0, "578e": 0, "78": 0, "300e": 0, "556e": 0, "64": 0, "297e": 0, "540e": 0, "66": 0, "275e": 0, "519e": 0, "68": 0, "65": 0, "270e": 0, "502e": 0, "70": 0, "94": 0, "281e": 0, "484e": 0, "23": 0, "245e": 0, "467e": 0, "51": 0, "301e": 0, "456e": 0, "80": 0, "33": 0, "268e": 0, "442e": 0, "262e": 0, "431e": 0, "82": 0, "235e": 0, "416e": 0, "84": 0, "67": 0, "240e": 0, "404e": 0, "96": 0, "49": 0, "256e": 0, "393e": 0, "89": 0, "237e": 0, "382e": 0, "91": 0, "53": 0, "215e": 0, "372e": 0, "93": 0, "291e": 0, "363e": 0, "199e": 0, "349e": 0, "98": 0, "40": 0, "271e": 0, "343e": 0, "train_loss": 0, "204e": 0, "train_ms": 0, "337e": 0, "val_loss": 0, "944e": 0, "val_ms": 0, "558e": 0, "628e": 0, "890e": 0, "619e": 0, "844e": 0, "626e": 0, "817e": 0, "614e": 0, "458e": 0, "610e": 0, "768e": 0, "606e": 0, "811e": 0, "595e": 0, "782e": 0, "596e": 0, "982e": 0, "173e": 0, "601e": 0, "807e": 0, "806e": 0, "611e": 0, "100": 0, "797e": 0, "612e": 0, "2337": 0, "2612": 0, "taken": 0, "42": 0, "second": 0, "247e": 0, "741e": 0, "217e": 0, "936e": 0, "181e": 0, "921e": 0, "131e": 0, "919e": 0, "986e": 0, "924e": 0, "576e": 0, "930e": 0, "624e": 0, "877e": 0, "045e": 0, "843e": 0, "37": 0, "980e": 0, "719e": 0, "522e": 0, "031e": 0, "499e": 0, "953e": 0, "179e": 0, "461e": 0, "032e": 0, "302e": 0, "882e": 0, "243e": 0, "744e": 0, "066e": 0, "617e": 0, "506e": 0, "356e": 0, "420e": 0, "726e": 0, "389e": 0, "155e": 0, "321e": 0, "796e": 0, "014e": 0, "178e": 0, "009e": 0, "117e": 0, "465e": 0, "060e": 0, "033e": 0, "964e": 0, "962e": 0, "632e": 0, "917e": 0, "501e": 0, "874e": 0, "563e": 0, "834e": 0, "799e": 0, "773e": 0, "397e": 0, "743e": 0, "068e": 0, "716e": 0, "56": 0, "868e": 0, "692e": 0, "452e": 0, "907e": 0, "642e": 0, "568e": 0, "620e": 0, "600e": 0, "772e": 0, "584e": 0, "100e": 0, "564e": 0, "008e": 0, "544e": 0, "253e": 0, "524e": 0, "504e": 0, "932e": 0, "491e": 0, "260e": 0, "593e": 0, "050e": 0, "819e": 0, "975e": 0, "706e": 0, "997e": 0, "375e": 0, "521e": 0, "952e": 0, "922e": 0, "47": 0, "124e": 0, "878e": 0, "446e": 0, "923e": 0, "869e": 0, "896e": 0, "685e": 0, "352e": 0, "926e": 0, "548e": 0, "933e": 0, "1491": 0, "0593": 0, "075e": 0, "084e": 0, "021e": 0, "948e": 0, "168e": 0, "071e": 0, "119e": 0, "515e": 0, "727e": 0, "228e": 0, "701e": 0, "380e": 0, "080e": 0, "954e": 0, "908e": 0, "495e": 0, "732e": 0, "201e": 0, "030e": 0, "018e": 0, "138e": 0, "161e": 0, "234e": 0, "594e": 0, "274e": 0, "973e": 0, "289e": 0, "989e": 0, "186e": 0, "116e": 0, "142e": 0, "012e": 0, "789e": 0, "101e": 0, "098e": 0, "842e": 0, "968e": 0, "35": 0, "845e": 0, "724e": 0, "733e": 0, "658e": 0, "503e": 0, "399e": 0, "994e": 0, "418e": 0, "588e": 0, "340e": 0, "040e": 0, "196e": 0, "229e": 0, "127e": 0, "951e": 0, "061e": 0, "912e": 0, "016e": 0, "959e": 0, "816e": 0, "913e": 0, "074e": 0, "827e": 0, "156e": 0, "775e": 0, "974e": 0, "720e": 0, "254e": 0, "640e": 0, "007e": 0, "527e": 0, "960e": 0, "552e": 0, "976e": 0, "957e": 0, "359e": 0, "326e": 0, "794e": 0, "950e": 0, "941e": 0, "450e": 0, "965e": 0, "345e": 0, "966e": 0, "0568": 0, "0297": 0, "946e": 0, "508e": 0, "004e": 0, "471e": 0, "652e": 0, "486e": 0, "650e": 0, "518e": 0, "803e": 0, "439e": 0, "689e": 0, "696e": 0, "166e": 0, "678e": 0, "543e": 0, "645e": 0, "147e": 0, "635e": 0, "631e": 0, "287e": 0, "625e": 0, "607e": 0, "761e": 0, "591e": 0, "813e": 0, "826e": 0, "750e": 0, "055e": 0, "886e": 0, "149e": 0, "901e": 0, "977e": 0, "838e": 0, "072e": 0, "983e": 0, "019e": 0, "013e": 0, "366e": 0, "299e": 0, "065e": 0, "137e": 0, "403e": 0, "038e": 0, "648e": 0, "010e": 0, "938e": 0, "046e": 0, "110e": 0, "536e": 0, "172e": 0, "158e": 0, "162e": 0, "093e": 0, "129e": 0, "547e": 0, "096e": 0, "346e": 0, "081e": 0, "427e": 0, "057e": 0, "373e": 0, "790e": 0, "770e": 0, "163e": 0, "728e": 0, "751e": 0, "718e": 0, "198e": 0, "705e": 0, "691e": 0, "118e": 0, "690e": 0, "660e": 0, "712e": 0, "881e": 0, "699e": 0, "006e": 0, "711e": 0, "918e": 0, "005e": 0, "0406": 0, "0271": 0, "666e": 0, "191e": 0, "396e": 0, "967e": 0, "440e": 0, "139e": 0, "115e": 0, "400e": 0, "526e": 0, "725e": 0, "756e": 0, "042e": 0, "723e": 0, "587e": 0, "512e": 0, "435e": 0, "437e": 0, "481e": 0, "417e": 0, "387e": 0, "134e": 0, "509e": 0, "111e": 0, "324e": 0, "097e": 0, "091e": 0, "277e": 0, "906e": 0, "438e": 0, "856e": 0, "898e": 0, "879e": 0, "963e": 0, "814e": 0, "769e": 0, "717e": 0, "745e": 0, "599e": 0, "370e": 0, "395e": 0, "721e": 0, "496e": 0, "203e": 0, "722e": 0, "850e": 0, "sol": [0, 2], "predict": [0, 4], "0x7fd2e4c88280": 0, "0x7fd2e4bfd490": 0, "test_dataset": [0, 4], "c_test": 0, "ysol": [0, 4], "valueerror": 0, "traceback": 0, "most": 0, "recent": 0, "call": [0, 2, 4], "last": 0, "home": 0, "carterrhea": 0, "document": 0, "ipynb": 0, "cell": 0, "modul": 0, "href": 0, "vscode": 0, "x15szmlszq": 0, "3d": 0, "line": 0, "file": 0, "miniconda3": 0, "env": 0, "astro": 0, "lib": 0, "python3": 0, "site": 0, "packag": 0, "python": [0, 1], "engin": 0, "base_lay": 0, "py": 0, "1012": 0, "__call__": 0, "self": 0, "kwarg": [0, 2, 4], "1008": 0, "_maybe_build": 0, "input": [0, 2, 4], "1010": 0, "autocast_vari": 0, "enable_auto_cast_vari": 0, "1011": 0, "_compute_dtype_object": 0, "output": 0, "call_fn": 0, "1014": 0, "_activity_regular": 0, "1015": 0, "_handle_activity_regular": 0, "401": 0, "393": 0, "394": 0, "A": [0, 2, 3, 4], "singl": [0, 2, 4], "run": [0, 2, 4], "through": [0, 2, 4], "purpos": [0, 4], "395": 0, "398": 0, "399": 0, "400": 0, "solut": [0, 2, 3, 4], "contain": 0, "all": [0, 4], "each": [0, 4], "timestep": [0, 4], "test_batch_step": 0, "y_batch_test": 0, "a_batch_test": 0, "c_batch_test": 0, "enumer": 0, "402": 0, "convert_to_tensor": 0, "dtype": 0, "int32": 0, "403": 0, "sol_t": [0, 4], "test_step": [0, 4], "enough": 0, "valu": [0, 2, 4], "unpack": 0, "expect": 0, "got": 0, "val": 0, "ysol_list": 0, "ysol_": 0, "reshap": 0, "140": 0, "print": 0, "fig": 0, "figur": 0, "figsiz": 0, "noisi": 0, "color": 0, "indian_r": 0, "prop": 0, "patch": 0, "set_facecolor": 0, "white": 0, "ylabel": 0, "y": [0, 3, 4], "axi": 0, "fontsiz": 0, "xlabel": 0, "xtick": 0, "ytick": 0, "titl": 0, "exampl": 0, "savefig": 0, "gaussian_noisi": 0, "png": 0, "c8": 0, "linewidth": 0, "gaussian_noisy_tru": 0, "linestyl": 0, "dash": 0, "c6": 0, "gaussian_complet": 0, "easi": 1, "modifi": 1, "enabl": 1, "user": [1, 4], "emploi": 1, "recurr": [1, 2, 4], "infer": [1, 2, 4], "machin": [1, 2, 4], "2d": [1, 4], "modular": 1, "manner": 1, "provid": 1, "standard": [1, 2], "configur": 1, "likelihood": [1, 2, 3], "howev": 1, "readili": 1, "specif": 1, "architectur": [1, 2], "you": 1, "find": 1, "outlin": 1, "methodologi": 1, "addition": 1, "abl": 1, "see": 1, "how": 1, "quickli": 1, "build": 1, "your": 1, "own": 1, "includ": 1, "denconvolut": 1, "api": 1, "here": 1, "well": 1, "sequenc": 1, "rim_model_1d": [1, 2], "rim_model_2d": [1, 2], "physic": 1, "calc_grad": [1, 3], "creat": [1, 2, 4], "convolv": 1, "imag": 1, "index": 1, "search": 1, "page": 1, "class": [2, 4], "rim_model": [2, 4], "ani": [2, 4], "subclass": [2, 4], "dimension": 2, "version": 2, "log_l": 2, "states1": 2, "none": 2, "states2": 2, "return_st": [2, 4], "fals": [2, 4], "conv2d": 2, "gru": 2, "conv2d_t": 2, "when": 2, "go": 2, "need": 2, "first": 2, "flatten": 2, "activ": 2, "map": 2, "expand_dim": 2, "function": [2, 3, 4], "make": 2, "sure": 2, "ha": 2, "correct": 2, "format": 2, "length": 2, "featur": 2, "dim": 2, "step": [2, 4], "t": 2, "x_t": 2, "gradient": [2, 3], "log": [2, 3], "hidden": [2, 4], "state": 2, "boolean": 2, "determin": 2, "whether": 2, "act": 2, "mode": 2, "delta": 2, "vector": [2, 4], "one": 2, "option": 2, "two": 2, "type": [2, 4], "param": 2, "calcul": [2, 3, 4], "rim_phys": 3, "c_n": 3, "unconvolv": 3, "covari": [3, 4], "current": [3, 4], "asinh": 3, "code": 4, "actual": 4, "If": 4, "assum": 4, "squar": 4, "assign_learning_rate_funct": 4, "learning_rate_funct": 4, "assign": 4, "learn": 4, "rate": 4, "base": 4, "off": 4, "": 4, "select": 4, "form": 4, "test_numb": 4, "exp_decai": 4, "updat": 4, "learrn": 4, "end": 4, "drop": 4, "decai": 4, "equat": 4, "lpha": 4, "rac": 4, "lpha_0": 4, "floor": 4, "epsilon": 4, "epoch_drop": 4, "full": 4, "algorithm": 4, "c_train": 4, "c_valid": 4, "training_loss_valu": 4, "valid_loss_valu": 4, "learning_rate_valu": 4, "init_sol": 4, "init_st": 4, "state1": 4, "state2": 4, "learning_rate_decai": 4, "mean_ms": 4, "y_true": 4, "x_sol": 4, "mean": 4, "error": 4, "over": 4, "step_decai": 4, "c": 4, "network": 4, "observ": 4, "respons": 4, "solution_step": 4, "train_step": 4, "vald": 4, "train_loss_fun": 4, "valid_step": 4, "val_loss_fun": 4}, "objects": {"": [[2, 0, 0, "-", "RIM_model"], [3, 0, 0, "-", "RIM_physical"], [4, 0, 0, "-", "RIM_sequence"]], "RIM_model": [[2, 1, 1, "", "RIM_Model_1D"], [2, 1, 1, "", "RIM_Model_2D"]], "RIM_model.RIM_Model_1D": [[2, 2, 1, "", "call"]], "RIM_model.RIM_Model_2D": [[2, 2, 1, "", "call"]], "RIM_physical": [[3, 3, 1, "", "calc_grad"]], "RIM_sequence": [[4, 1, 1, "", "RIM"]], "RIM_sequence.RIM": [[4, 2, 1, "", "assign_learning_rate_function"], [4, 2, 1, "", "call"], [4, 2, 1, "", "exp_decay"], [4, 2, 1, "", "fit"], [4, 2, 1, "", "init_sol"], [4, 2, 1, "", "init_states"], [4, 2, 1, "", "learning_rate_decay"], [4, 2, 1, "", "mean_mse"], [4, 2, 1, "", "predict"], [4, 2, 1, "", "step_decay"], [4, 2, 1, "", "test_step"], [4, 2, 1, "", "train_step"], [4, 2, 1, "", "valid_step"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"recurr": 0, "infer": 0, "machin": 0, "creat": 0, "convolv": 0, "imag": 0, "welcom": 1, "astrorim": 1, "": 1, "document": 1, "content": 1, "exampl": 1, "modul": 1, "indic": 1, "tabl": 1, "rim": [2, 3, 4], "model": 2, "physic": 3, "sequenc": 4}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "nbsphinx": 4, "sphinx": 57}, "alltitles": {"Recurrent Inference Machines": [[0, "Recurrent-Inference-Machines"]], "Create Convolved Image": [[0, "Create-Convolved-Image"]], "Recurrent Inference Machine": [[0, "Recurrent-Inference-Machine"]], "Welcome to astroRIM\u2019s documentation!": [[1, "welcome-to-astrorim-s-documentation"]], "Contents:": [[1, null]], "Examples": [[1, "examples"]], "Example Modules:": [[1, null]], "Indices and tables": [[1, "indices-and-tables"]], "RIM Model": [[2, "module-RIM_model"]], "RIM Physical": [[3, "module-RIM_physical"]], "RIM Sequence": [[4, "module-RIM_sequence"]]}, "indexentries": {"rim_model_1d (class in rim_model)": [[2, "RIM_model.RIM_Model_1D"]], "rim_model_2d (class in rim_model)": [[2, "RIM_model.RIM_Model_2D"]], "rim_model": [[2, "module-RIM_model"]], "call() (rim_model.rim_model_1d method)": [[2, "RIM_model.RIM_Model_1D.call"]], "call() (rim_model.rim_model_2d method)": [[2, "RIM_model.RIM_Model_2D.call"]], "module": [[2, "module-RIM_model"], [3, "module-RIM_physical"], [4, "module-RIM_sequence"]], "rim_physical": [[3, "module-RIM_physical"]], "calc_grad() (in module rim_physical)": [[3, "RIM_physical.calc_grad"]], "rim (class in rim_sequence)": [[4, "RIM_sequence.RIM"]], "rim_sequence": [[4, "module-RIM_sequence"]], "assign_learning_rate_function() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.assign_learning_rate_function"]], "call() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.call"]], "exp_decay() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.exp_decay"]], "fit() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.fit"]], "init_sol() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.init_sol"]], "init_states() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.init_states"]], "learning_rate_decay() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.learning_rate_decay"]], "mean_mse() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.mean_mse"]], "predict() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.predict"]], "step_decay() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.step_decay"]], "test_step() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.test_step"]], "train_step() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.train_step"]], "valid_step() (rim_sequence.rim method)": [[4, "RIM_sequence.RIM.valid_step"]]}})